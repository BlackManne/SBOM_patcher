{"No": "CVE-2020-19952", "title": "NVD - CVE-2020-19952", "description": "Cross Site Scripting (XSS) vulnerability in Rendering Engine in jbt Markdown Editor thru commit 2252418c27dffbb35147acd8ed324822b8919477, allows remote attackers to execute arbirary code via crafted payload or opening malicious .md file.", "score": "6.1 MEDIUM", "source_url": "https://nvd.nist.gov/vuln/detail/CVE-2020-19952", "affected_software": [{"software_name": "jbt:live_\\(github-flavored\\)_markdown_editor:*:*:*:*:*:*:*:*", "interval_versions": ["<2019-10-27"], "detail_versions": [], "raw_versions": ["jbt:live_\\(github-flavored\\)_markdown_editor:*:*:*:*:*:*:*:* versions up to (excluding) 2019-10-27"]}], "patch_list": [{"patch_url": "https://github.com/jbt/markdown-editor/commit/228f1947a5242a6fbe2995d72d21b7e5f5178f35", "service_name": "github_commit", "patch_detail": {"message": "Add xss documentation", "changes": {"total": 25, "additions": 25, "deletions": 0}, "files": [{"filename": "docs/changelog.md", "additions": 0, "deletions": 0, "blob_url": "https://github.com/jbt/markdown-editor/blob/228f1947a5242a6fbe2995d72d21b7e5f5178f35/docs%2Fchangelog.md", "diff": null}, {"filename": "docs/xss_fix.md", "additions": 25, "deletions": 0, "blob_url": "https://github.com/jbt/markdown-editor/blob/228f1947a5242a6fbe2995d72d21b7e5f5178f35/docs%2Fxss_fix.md", "diff": "@@ -0,0 +1,25 @@\n+# Cross-Site Scripting Fix\n+\n+Issue [#106](https://github.com/jbt/markdown-editor/issues/106) reports that the application\n+has cross-site scripting (XSS) vulnerabilities.\n+\n+## XSS Attack Examples\n+\n+```\n+<EMBED SRC=\"data:image/svg+xml;base64 PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGlkPSJ4c3MiPjxzY3JpcHQgdHlwZT0idGV4dC9lY21hc2NyaXB0Ij5hbGVydCgieHNzISIpOzwvc2NyaXB0Pjwvc3ZnPg==\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"></EMBED>\n+```\n+\n+```\n+<sup style=\"position:fixed;left:0;top:0;width:10000px;height:10000px;\" onmouseover=\"alert('xss')\">sup</sup>\n+```\n+\n+```\n+<abbr style=\"position:fixed;left:0;top:0;width:10000px;height:10000px;\" onmouseover=\"alert('xss')\">abbr</abbr>\n+```\n+\n+## Current Solution\n+\n+* When changes are made in the CodeMirror editor, search through the new value using a regular expression to match all HTML elements which satisfy one of the following conditions:\n+    * The `AllowScriptAccess` attribute is set to `always` or `sameDomain`.\n+    * An attribute with the `on` prefix is present, indicating an event handler is being attached to the element (i.e. `onmouseover`).\n+* For each match, remove the entire HTML element string from the new value before updating the markdown preview. Both the CodeMirror editor and markdown preview will no longer contain the illegal HTML input.\n\\ No newline at end of file"}]}, "time": "2024-07-10 22:13:10"}, {"patch_url": "https://github.com/jbt/markdown-editor/pull/110", "service_name": "github_pull", "patch_detail": {"title": "Fix XSS Vulnerability", "labels": [], "created_time": "2019-10-25T23:32:55Z", "updated_time": "2023-05-13T21:42:48Z", "closed_time": "2023-05-13T21:42:48Z", "content": "This is an initial attempt to fix XSS scenarios noted in https://github.com/jbt/markdown-editor/issues/106. If any AllowScriptAccess attributes are found in HTML elements, or if any event handler attributes are set to HTML elements, then the related text will be automatically removed from the CodeMirror textarea. It also alerts the user with a descriptive message on why their added text was filtered out.\n", "comments": [{"type": "comment", "content": "@aero31aero I'd like to assign you as a reviewer to this pull request, please let me know if you have any suggestions. I feel like this should be merged in as soon as possible since the current live version of the editor can be exploited with XSS attacks and the link-sharing feature amplifies how dangerous it can be."}]}, "time": "2024-07-10 22:13:14"}]}