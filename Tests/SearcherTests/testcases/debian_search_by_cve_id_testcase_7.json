{"No": "CVE-2023-28686", "source_url": "https://security-tracker.debian.org/tracker/CVE-2023-28686", "ref_links": ["https://dino.im/security/cve-2023-28686/", "Fixed by:https://github.com/dino/dino/commit/ef8fb0e94ce79d5fde2943e433ad0422eb7f70ec", "Fixed by:https://github.com/dino/dino/commit/baf96d9d9fac7480fed777ac87d917f8dec8f0f6(v0.4.2)", "Fixed by:https://github.com/dino/dino/commit/e02a443a4eaf02f0ab860b41d0bc7081d4110ab4(v0.2.3)", "Bookmark supported added inhttps://github.com/dino/dino/commit/74c29d4df19f97b9b67bbc3c1a963a8729be69fd(v0.1.0)"], "patch_list": [{"patch_url": "https://github.com/dino/dino/commit/ef8fb0e94ce79d5fde2943e433ad0422eb7f70ec", "service_name": "github_commit", "patch_detail": {"message": "Check sender of bookmark:1 updates", "changes": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"filename": "xmpp-vala/src/module/xep/0402_bookmarks2.vala", "additions": 10, "deletions": 0, "blob_url": "https://github.com/dino/dino/blob/ef8fb0e94ce79d5fde2943e433ad0422eb7f70ec/xmpp-vala%2Fsrc%2Fmodule%2Fxep%2F0402_bookmarks2.vala", "diff": "@@ -68,6 +68,11 @@ public class Module : BookmarksProvider, XmppStreamModule {\n     }\n \n     private void on_pupsub_item(XmppStream stream, Jid jid, string id, StanzaNode? node) {\n+        if (!jid.equals(stream.get_flag(Bind.Flag.IDENTITY).my_jid.bare_jid)) {\n+            warning(\"Received alleged bookmarks:1 item from %s, ignoring\", jid.to_string());\n+            return;\n+        }\n+\n         Conference conference = parse_item_node(node, id);\n         Flag? flag = stream.get_flag(Flag.IDENTITY);\n         if (flag != null) {\n@@ -77,6 +82,11 @@ public class Module : BookmarksProvider, XmppStreamModule {\n     }\n \n     private void on_pupsub_retract(XmppStream stream, Jid jid, string id) {\n+        if (!jid.equals(stream.get_flag(Bind.Flag.IDENTITY).my_jid.bare_jid)) {\n+            warning(\"Received alleged bookmarks:1 retract from %s, ignoring\", jid.to_string());\n+            return;\n+        }\n+\n         try {\n             Jid jid_parsed = new Jid(id);\n             Flag? flag = stream.get_flag(Flag.IDENTITY);"}]}, "time": "2024-08-18 22:31:00"}, {"patch_url": "https://github.com/dino/dino/commit/baf96d9d9fac7480fed777ac87d917f8dec8f0f6", "service_name": "github_commit", "patch_detail": {"message": "Check sender of bookmark:1 updates", "changes": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"filename": "xmpp-vala/src/module/xep/0402_bookmarks2.vala", "additions": 10, "deletions": 0, "blob_url": "https://github.com/dino/dino/blob/baf96d9d9fac7480fed777ac87d917f8dec8f0f6/xmpp-vala%2Fsrc%2Fmodule%2Fxep%2F0402_bookmarks2.vala", "diff": "@@ -68,6 +68,11 @@ public class Module : BookmarksProvider, XmppStreamModule {\n     }\n \n     private void on_pupsub_item(XmppStream stream, Jid jid, string id, StanzaNode? node) {\n+        if (!jid.equals(stream.get_flag(Bind.Flag.IDENTITY).my_jid.bare_jid)) {\n+            warning(\"Received alleged bookmarks:1 item from %s, ignoring\", jid.to_string());\n+            return;\n+        }\n+\n         Conference conference = parse_item_node(node, id);\n         Flag? flag = stream.get_flag(Flag.IDENTITY);\n         if (flag != null) {\n@@ -77,6 +82,11 @@ public class Module : BookmarksProvider, XmppStreamModule {\n     }\n \n     private void on_pupsub_retract(XmppStream stream, Jid jid, string id) {\n+        if (!jid.equals(stream.get_flag(Bind.Flag.IDENTITY).my_jid.bare_jid)) {\n+            warning(\"Received alleged bookmarks:1 retract from %s, ignoring\", jid.to_string());\n+            return;\n+        }\n+\n         try {\n             Jid jid_parsed = new Jid(id);\n             Flag? flag = stream.get_flag(Flag.IDENTITY);"}]}, "time": "2024-08-18 22:31:01"}, {"patch_url": "https://github.com/dino/dino/commit/e02a443a4eaf02f0ab860b41d0bc7081d4110ab4", "service_name": "github_commit", "patch_detail": {"message": "Check sender of bookmark:1 updates", "changes": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"filename": "xmpp-vala/src/module/xep/0402_bookmarks2.vala", "additions": 10, "deletions": 0, "blob_url": "https://github.com/dino/dino/blob/e02a443a4eaf02f0ab860b41d0bc7081d4110ab4/xmpp-vala%2Fsrc%2Fmodule%2Fxep%2F0402_bookmarks2.vala", "diff": "@@ -57,6 +57,11 @@ public class Module : BookmarksProvider, XmppStreamModule {\n     }\n \n     private void on_pupsub_item(XmppStream stream, Jid jid, string id, StanzaNode? node) {\n+        if (!jid.equals(stream.get_flag(Bind.Flag.IDENTITY).my_jid.bare_jid)) {\n+            warning(\"Received alleged bookmarks:1 item from %s, ignoring\", jid.to_string());\n+            return;\n+        }\n+\n         Conference conference = parse_item_node(node, id);\n         Flag? flag = stream.get_flag(Flag.IDENTITY);\n         if (flag != null) {\n@@ -66,6 +71,11 @@ public class Module : BookmarksProvider, XmppStreamModule {\n     }\n \n     private void on_pupsub_retract(XmppStream stream, Jid jid, string id) {\n+        if (!jid.equals(stream.get_flag(Bind.Flag.IDENTITY).my_jid.bare_jid)) {\n+            warning(\"Received alleged bookmarks:1 retract from %s, ignoring\", jid.to_string());\n+            return;\n+        }\n+\n         try {\n             Jid jid_parsed = new Jid(id);\n             Flag? flag = stream.get_flag(Flag.IDENTITY);"}]}, "time": "2024-08-18 22:31:02"}]}